{
  "name": "Enhanced Equivalent Cycles (continuous SOC)",
  "version": "1.1.0",
  "description": "Counts standard equivalent full cycles and a condition-weighted equivalent cycle count with continuous SOC stress for realistic, chemistry-tunable penalties (LFP defaults included).",
  "category": "Health",
  "inputs": {
    "current": {
      "unit": "A",
      "type": "pd.Series",
      "description": "Battery current (abs used)",
      "required": true
    },
    "soc": {
      "unit": "p.u.",
      "type": "pd.Series",
      "description": "State of charge in [0..1]. If absent, assumed 0.5.",
      "required": false
    },
    "temperature": {
      "unit": "째C",
      "type": "pd.Series",
      "description": "Cell/pack temperature. If absent, assumed 25 째C.",
      "required": false
    },
    "capacity": {
      "unit": "Ah",
      "type": "float",
      "description": "Nominal capacity used for cycle normalization",
      "required": true
    },
    "rated_cycle_count": {
      "unit": "cycles",
      "type": "float",
      "description": "Rated cycle life at reference conditions",
      "required": true
    }
  },
  "outputs": {
    "std_cycle_count": {
      "unit": "cycles",
      "type": "pd.Series",
      "description": "Baseline equivalent full cycles from Ah throughput"
    },
    "equivalent_cycle_count": {
      "unit": "cycles",
      "type": "pd.Series",
      "description": "Condition-weighted equivalent cycles (C-rate, continuous SOC, temperature)"
    },
    "cycle_life_fraction": {
      "unit": "p.u.",
      "type": "pd.Series",
      "description": "equivalent_cycle_count / rated_cycle_count"
    }
  },

  "configuration": {
    "soc_weight_mode": {
      "description": "SOC weighting mode ('smoothstep' or 'off')",
      "type": "string",
      "default": "smoothstep"
    },
    "soc_sustain_tau_hours": {
      "description": "EMA horizon for sustained SOC (hours)",
      "type": "number",
      "default": 1.5
    },
    "soc_high_onset": {
      "description": "Start of high-SOC ramp (p.u.)",
      "type": "number",
      "default": 0.75
    },
    "soc_high_full": {
      "description": "SOC where high-SOC penalty saturates (p.u.)",
      "type": "number",
      "default": 0.95
    },
    "soc_high_gain": {
      "description": "Max added multiplier at high SOC (e.g., 0.6 -> +60%)",
      "type": "number",
      "default": 0.6
    },
    "soc_high_pow": {
      "description": "Shape exponent for high-SOC ramp (>=1)",
      "type": "number",
      "default": 1.0
    },
    "soc_low_onset": {
      "description": "SOC where low-SOC ramp begins (p.u.)",
      "type": "number",
      "default": 0.08
    },
    "soc_low_full": {
      "description": "SOC where low-SOC penalty saturates (p.u.)",
      "type": "number",
      "default": 0.02
    },
    "soc_low_gain": {
      "description": "Max added multiplier at very low SOC",
      "type": "number",
      "default": 0.1
    },
    "soc_low_pow": {
      "description": "Shape exponent for low-SOC ramp (>=1)",
      "type": "number",
      "default": 1.0
    },
    "soc_apply": {
      "description": "Apply SOC weight during 'charge' | 'discharge' | 'both'",
      "type": "string",
      "default": "both"
    },
    "c_rate_ref": {
      "description": "Reference C-rate (~rated condition)",
      "type": "number",
      "default": 0.5
    },
    "c_rate_exponent": {
      "description": "Exponent for high C-rate penalty",
      "type": "number",
      "default": 1.0
    },
    "alpha_c": {
      "description": "Penalty factor above c_rate_ref",
      "type": "number",
      "default": 1.5
    },
    "beta_c": {
      "description": "Relief factor below c_rate_ref",
      "type": "number",
      "default": 0.3
    },
    "q10": {
      "description": "Temperature factor per 10 째C",
      "type": "number",
      "default": 2.0
    },
    "temp_ref_c": {
      "description": "Reference temperature (째C)",
      "type": "number",
      "default": 25.0
    },
    "sustain_tau_hours": {
      "description": "EMA horizon for sustained C-rate (hours)",
      "type": "number",
      "default": 0.5
    },
    "eps_current": {
      "description": "Current activity gate (A)",
      "type": "number",
      "default": 0.001
    },
    "min_weight": {
      "description": "Lower clamp on total stress multiplier",
      "type": "number",
      "default": 0.2
    },
    "max_weight": {
      "description": "Upper clamp on total stress multiplier",
      "type": "number",
      "default": 5.0
    }
  }
}